<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kuis Anak Ngaji</title>

<style>
body {
  font-family: "Comic Sans MS", Arial, sans-serif;
  background: linear-gradient(135deg, #84fab0, #8fd3f4);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}
.card {
  background: #fff;
  width: 90%;
  max-width: 700px;
  padding: 30px;
  border-radius: 20px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.2);
  text-align: center;
}
button {
  width: 100%;
  padding: 12px;
  margin: 8px 0;
  border: none;
  border-radius: 12px;
  font-size: 16px;
  cursor: pointer;
  background: #4facfe;
  color: white;
}
.feedback-correct { color: green; font-weight: bold; }
.feedback-incorrect { color: red; font-weight: bold; }
.progress-bar {
  width: 100%;
  height: 25px;
  background: #e0e0e0;
  border-radius: 10px;
  overflow: hidden;
  margin: 10px 0;
}
.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, #4facfe, #00f2fe);
  width: 0%;
  transition: width 0.3s ease;
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-size: 12px;
  font-weight: bold;
}

/* RESPONSIVE DESIGN */
@media (max-width: 768px) {
  body {
    padding: 10px;
  }
  
  .card {
    width: 100%;
    max-width: 100%;
    padding: 20px;
    border-radius: 15px;
  }
  
  h1 {
    font-size: 20px;
    margin-bottom: 15px;
  }
  
  h2 {
    font-size: 18px;
  }
  
  button {
    padding: 10px;
    font-size: 14px;
    margin: 6px 0;
  }
  
  #playerName {
    font-size: 16px;
  }
  
  p {
    font-size: 14px;
  }
  
  #question {
    font-size: 16px;
    margin: 15px 0;
  }
}

@media (max-width: 480px) {
  body {
    padding: 8px;
  }
  
  .card {
    padding: 15px;
    border-radius: 12px;
  }
  
  h1 {
    font-size: 18px;
    margin-bottom: 12px;
  }
  
  h2 {
    font-size: 16px;
  }
  
  button {
    padding: 10px;
    font-size: 13px;
    margin: 5px 0;
  }
  
  #playerName {
    font-size: 14px;
    padding: 8px;
  }
  
  p {
    font-size: 13px;
  }
  
  #question {
    font-size: 15px;
    margin: 12px 0;
  }
  
  .progress-bar {
    height: 20px;
    margin: 8px 0;
  }
  
  .progress-fill {
    font-size: 10px;
  }
}

@media (max-width: 360px) {
  .card {
    padding: 12px;
  }
  
  h1 {
    font-size: 16px;
  }
  
  button {
    padding: 8px;
    font-size: 12px;
  }
  
  #playerName {
    font-size: 13px;
    padding: 6px;
  }
}
</style>
</head>

<body>

<div class="card">

<!-- START SCREEN -->
<div id="startScreen">
  <h1>üïå Kuis Pengetahuan Mengaji Masjid Roisiyah üïå</h1>
  <input type="text" id="playerName" placeholder="Masukkan Nama" style="padding:10px;width:100%;margin-bottom:10px">
  <button onclick="startQuiz()">üöÄ Mulai Kuis</button>
</div>

<!-- QUIZ SCREEN -->
<div id="quizScreen" style="display:none;">
  <div style="margin-bottom:20px;background:#f9f9f9;padding:15px;border-radius:10px;">
    <p style="margin:5px 0;font-size:14px;">üìã Soal <span id="questionNum">1</span> dari <span id="totalQuestion">3</span></p>
    <div class="progress-bar">
      <div class="progress-fill" id="scoreProgress" style="width:0%;">0%</div>
    </div>
    <p style="margin:10px 0 0 0;font-size:18px;">‚≠ê Point: <span id="point" style="font-weight:bold;color:#4facfe;">0</span></p>
  </div>
  <p id="question"></p>
  <button id="o0" onclick="answer(0)"></button>
  <button id="o1" onclick="answer(1)"></button>
  <button id="o2" onclick="answer(2)"></button>
  <button id="o3" onclick="answer(3)"></button>
  <p id="feedback"></p>
  <p style="font-size:14px;color:#ff6b6b;margin-top:10px;">‚ùå Kesalahan: <span id="wrongCount" style="font-weight:bold;">0</span>/5</p>
</div>

<!-- GAME OVER SCREEN -->
<div id="gameOverScreen" style="display:none;">
  <h2 style="color:#ff6b6b;">üíÄ GAME OVER</h2>
  <p id="gameOverPlayerName" style="font-size:18px;margin-bottom:20px;"></p>
  <div style="background:#ffe6e6;padding:20px;border-radius:10px;margin-bottom:15px;border-left:5px solid #ff6b6b;">
    <p style="margin:10px 0;font-size:16px;">Anda telah melakukan <span style="font-weight:bold;">5 kesalahan</span></p>
    <p style="margin:10px 0;font-size:16px;">Soal dijawab: <span id="gameOverQuestions" style="font-weight:bold;"></span></p>
    <p style="margin:10px 0;font-size:16px;">üìä Point Terkumpul: <span id="gameOverPoint" style="font-weight:bold;color:#4facfe;"></span></p>
  </div>
  <p style="font-size:14px;margin-bottom:20px;color:#666;">Coba lagi untuk mendapatkan skor yang lebih baik!</p>
  <button onclick="location.reload()">üîÑ Main Lagi</button>
</div>

<!-- RESULT SCREEN -->
<div id="resultScreen" style="display:none;">
  <h2>Hasil Akhir</h2>
  <p id="playerNameDisplay" style="font-size:18px;margin-bottom:20px;"></p>
  <div style="background:#f0f0f0;padding:15px;border-radius:10px;margin-bottom:15px;">
    <p style="margin:5px 0;font-size:16px;">‚≠ê Point: <span id="finalPoint" style="font-weight:bold;color:#4facfe;"></span></p>
    <p style="margin:5px 0;font-size:16px;">üìä Nilai: <span id="finalScore" style="font-weight:bold;color:#4facfe;"></span>%</p>
    <p style="margin:5px 0;font-size:16px;">üèÜ Peringkat: <span id="finalRank" style="font-weight:bold;color:#ff6b6b;"></span></p>
  </div>
  <p id="rankMessage" style="font-size:16px;margin-bottom:20px;"></p>
  <button onclick="location.reload()">üîÑ Main Lagi</button>
</div>

</div>

<script>
const GOOGLE_APPS_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwn0JLkBQkS3O_WYhY6bfz_IdIXGQoEXJr68ciGcwM_S947L_r0cHa94rDns_Jdl7h8Fw/exec";

const soalBank = [
  // HUKUM NUN SUKUN DAN TANWIN (12 soal)
  { q:"Hukum nun sukun bertemu ÿ® adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:0 },
  { q:"Hukum nun sukun bertemu ÿ™ adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:0 },
  { q:"Hukum nun sukun bertemu ÿ´ adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:1 },
  { q:"Hukum nun sukun bertemu ÿ¨ adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:1 },
  { q:"Hukum nun sukun bertemu ÿØ adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:0 },
  { q:"Hukum nun sukun bertemu ŸÑ adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:0 },
  { q:"Tanwin bertemu ÿ® hukumnya adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:2 },
  { q:"Tanwin bertemu ÿ™ hukumnya adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:0 },
  { q:"Tanwin bertemu ÿ´ hukumnya adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:1 },
  { q:"Tanwin bertemu ÿ¨ hukumnya adalah?", o:["Idhgham","Ikhfa","Iqlab","Idzhar"], a:1 },
  { q:"Nun sukun yang tidak boleh diidzharkan adalah?", o:["Bertemu Ha","Bertemu Ra","Bertemu Lam","Bertemu Mim"], a:2 },
  { q:"Tanwin dengan ghunnah terjadi pada?", o:["Semua huruf","Beberapa huruf","Hanya 4 huruf","Tidak ada"], a:1 },
  
  // HUKUM MIM SUKUN (8 soal)
  { q:"Hukum mim sukun bertemu ÿ® adalah?", o:["Idhgham Mimi","Ikhfa Syafawi","Idzhar Syafawi","Iqlab"], a:0 },
  { q:"Hukum mim sukun bertemu ŸÖ adalah?", o:["Idhgham Mimi","Ikhfa Syafawi","Idzhar Syafawi","Iqlab"], a:0 },
  { q:"Hukum mim sukun bertemu ŸÅ adalah?", o:["Idhgham Mimi","Ikhfa Syafawi","Idzhar Syafawi","Iqlab"], a:1 },
  { q:"Hukum mim sukun bertemu ÿß adalah?", o:["Idhgham Mimi","Ikhfa Syafawi","Idzhar Syafawi","Iqlab"], a:2 },
  { q:"Ikhfa Syafawi menyamarkan dengan cara?", o:["Tanpa Ghunnah","Dengan Ghunnah","Penuh","Setengah"], a:1 },
  { q:"Suara mim sukun keluar dari?", o:["Lidah","Bibir","Hidung","Gusi"], a:1 },
  { q:"Mim bertasydid bacaannya disertai?", o:["Tanpa Ghunnah","Dengan Ghunnah","Idzhar","Iqlab"], a:1 },
  { q:"Mim Sukun ketika bertemu dengan huruf ÿ® disebut?", o:["Idhgham Mimi","Ikhfa Syafawi","Idzhar Syafawi","Iqlab"], a:0 },
  
  // GHUNNAH MUSYADDADAH (3 soal)
  { q:"Ghunnah Musyaddadah terjadi pada huruf?", o:["Nun bertasydid","Mim bertasydid","Keduanya","Tidak keduanya"], a:2 },
  { q:"Panjang Ghunnah Musyaddadah adalah?", o:["1 harakat","2 harakat","3 harakat","4 harakat"], a:1 },
  { q:"Tempat keluarnya suara Ghunnah adalah?", o:["Mulut","Hidung","Lidah","Gigi"], a:1 },
  
  // FIQIH TENTANG AIR (8 soal)
  { q:"Berapa jenis air menurut fiqih?", o:["2","3","4","5"], a:1 },
  { q:"Air Mutlak adalah air yang?", o:["Dicampur dengan sesuatu","Murni tanpa campuran","Panas","Dingin"], a:1 },
  { q:"Air suci dari najis adalah?", o:["Air yang mengalir","Air yang terkena najis","Air zamzam","Semua benar"], a:0 },
  { q:"Wudhu dengan air yang jumlahnya sedikit adalah?", o:["Haram","Makruh","Boleh","Wajib"], a:2 },
  { q:"Najis dapat dihilangkan dengan air?", o:["Satu tetes","Dua tetes","Enam tetes","Tidak bisa"], a:2 },
  { q:"Air untuk wudhu harus?", o:["Hangat","Suci dari najis","Bersih","Semua benar"], a:3 },
  { q:"Jika tidak ada air untuk wudhu, penggantiannya adalah?", o:["Tayammum","Langsung shalat","Berwudhu nanti","Tidak shalat"], a:0 },
  { q:"Mandi wajib dilakukan setelah?", o:["Bermain","Tidur","Junub (bersetubuh)","Makan"], a:2 },
  
  // RUKUN IMAN (6 soal)
  { q:"Rukun Iman ada berapa?", o:["4","5","6","7"], a:2 },
  { q:"Percaya kepada Allah adalah rukun iman yang ke?", o:["Pertama","Kedua","Ketiga","Keempat"], a:0 },
  { q:"Rukun Iman yang kedua adalah?", o:["Percaya kepada Malaikat","Percaya kepada Kitab","Percaya kepada Nabi","Percaya kepada Qada dan Qadar"], a:0 },
  { q:"Rukun Iman yang ketiga adalah?", o:["Percaya kepada Malaikat","Percaya kepada Kitab Suci","Percaya kepada Nabi","Percaya kepada Qada dan Qadar"], a:1 },
  { q:"Percaya kepada Nabi dan Rasul adalah rukun iman yang ke?", o:["Ketiga","Keempat","Kelima","Keenam"], a:1 },
  { q:"Rukun Iman yang terakhir adalah?", o:["Percaya kepada Malaikat","Percaya kepada Kitab","Percaya kepada Hari Akhir","Percaya kepada Qada dan Qadar"], a:3 },
  
  // RUKUN ISLAM (5 soal)
  { q:"Rukun Islam ada berapa?", o:["3","4","5","6"], a:2 },
  { q:"Rukun Islam yang pertama adalah?", o:["Shalat","Syahadat","Zakat","Haji"], a:1 },
  { q:"Rukun Islam yang kedua adalah?", o:["Syahadat","Shalat Lima Waktu","Zakat","Puasa"], a:1 },
  { q:"Zakat adalah rukun islam yang ke?", o:["Kedua","Ketiga","Keempat","Kelima"], a:2 },
  { q:"Haji adalah rukun islam yang ke?", o:["Ketiga","Keempat","Kelima","Keenam"], a:2 },
  
  // CERITA NABI (10 soal)
  { q:"Nabi Nuh diutus selama berapa tahun?", o:["500","800","900","950"], a:2 },
  { q:"Bangsa yang diutus Nabi Hud adalah?", o:["Ad","Tsamud","Quraisy","Firaun"], a:0 },
  { q:"Nabi Ibrahim dipanggil sebagai?", o:["Khalil Allah","Amir Al-Mu'minin","Rasul Allah","Nabi Terbaik"], a:0 },
  { q:"Ismail adalah anak dari Nabi?", o:["Ibrahim","Ishaq","Yakub","Yusuf"], a:0 },
  { q:"Nabi Musa menerima kitab berupa?", o:["Qur'an","Taurat","Injil","Zabur"], a:1 },
  { q:"Nabi Isa adalah anak dari?", o:["Maryam","Aminah","Khadijah","Hawa"], a:0 },
  { q:"Mukjizat Nabi Isa yang terkenal adalah?", o:["Tongkat","Menghidupkan yang mati","Loh Mahfuzh","Cahaya bulan"], a:1 },
  { q:"Firaun adalah penguasa?", o:["Syam","Mesir","Yaman","Hijaz"], a:1 },
  { q:"Salib (penyalib) kaum Firaun disebut?", o:["Tanut","Haman","Qarun","Al-Walid"], a:1 },
  { q:"Nabi Daud menerima kitab berupa?", o:["Qur'an","Taurat","Zabur","Injil"], a:2 },
  
  // 4 SAHABAT UTAMA NABI (6 soal)
  { q:"Sahabat utama Nabi yang pertama adalah?", o:["Umar","Uthman","Abu Bakar","Ali"], a:2 },
  { q:"Gelar Abu Bakar adalah?", o:["Al-Faruq","Ash-Shiddiq","Dhul-Nuraini","Asadullah"], a:1 },
  { q:"Gelar Umar bin Khattab adalah?", o:["Ash-Shiddiq","Al-Faruq","Dhul-Nuraini","Asadullah"], a:1 },
  { q:"Gelar Uthman bin Affan adalah?", o:["Ash-Shiddiq","Al-Faruq","Dhul-Nuraini","Al-Ghani"], a:2 },
  { q:"Gelar Ali bin Abi Talib adalah?", o:["Ash-Shiddiq","Al-Faruq","Asadullah","Dhul-Nuraini"], a:2 },
  { q:"Khalifah pertama setelah Nabi Muhammad adalah?", o:["Umar","Uthman","Abu Bakar","Ali"], a:2 },
  
  // DOA SEHARI-HARI (10 soal)
  { q:"Doa sebelum makan adalah?", o:["Assalamualaikum","Bismillah","Alhamdulillah","Subhanallah"], a:1 },
  { q:"Doa sesudah makan adalah?", o:["Alhamdulillah","Bismillah","Subhanallah","Astaghfirullah"], a:0 },
  { q:"Doa masuk rumah dimulai dengan?", o:["Assalamualaikum","Bismillah Allahu Akbar","Alhamdulillah","Subhanallah"], a:1 },
  { q:"Doa keluar rumah dimulai dengan?", o:["Assalamualaikum","Bismillah Allahu Akbar","Alhamdulillah","Subhanallah"], a:1 },
  { q:"Doa bangun tidur adalah?", o:["Subhanallah","Alhamdulillah","Astaghfirullah","Bismillah"], a:1 },
  { q:"Doa sebelum tidur adalah?", o:["Assalamualaikum","Astaghfirullah","Alhamdulillah wa syukran","Subhanallah wa bihamdihi"], a:3 },
  { q:"Doa sebelum belajar dimulai dengan?", o:["Bismillah","Assalamualaikum","Alhamdulillah","Subhanallah"], a:0 },
  { q:"Doa saat melihat sesuatu yang indah adalah?", o:["Mashallah","Alhamdulillah","Subhanallah","Astaghfirullah"], a:0 },
  { q:"Doa saat bersin dimulai dengan?", o:["Alhamdulillah","Bismillah","Subhanallah","Assalamualaikum"], a:0 },
  { q:"Doa mendengar panggilan adzan adalah?", o:["Takbir","Tahlil","Repeating the adzan words","Shalawat"], a:2 },
  
  // TAMBAHAN UNTUK LENGKAP 50 SOAL
  { q:"Idzhar Hakiki terjadi ketika?", o:["Nun sukun bertemu ha","Huruf hidup bertemu ha","Mim sukun bertemu ha","Tanwin bertemu ha"], a:1 },
  { q:"Iqlab terjadi ketika?", o:["Nun sukun bertemu ba","Tanwin bertemu ba","Mim sukun bertemu ba","Huruf hidup bertemu ba"], a:1 },
  { q:"Rukun Islam yang keempat adalah?", o:["Shalat","Zakat","Puasa","Haji"], a:2 },
  { q:"Nabi Yusuf dikenal dengan julukan?", o:["Al-Aziz","Ash-Shiddiq","Al-Mustafa","Al-Karim"], a:0 },
  { q:"Nabi yang terkenal dengan kesabarannya adalah?", o:["Nabi Ayub","Nabi Musa","Nabi Ibrahim","Nabi Nuh"], a:0 }
];

let soal = [];
let i = 0;
let point = 0;
let wrong = 0;
let playerName = "";

function startQuiz() {
  playerName = document.getElementById("playerName").value.trim();
  if (!playerName) {
    alert("Masukkan nama terlebih dahulu");
    return;
  }

  soal = soalBank.sort(() => Math.random() - 0.5).slice(0, 15);
  i = 0;
  point = 0;
  wrong = 0;

  document.getElementById("startScreen").style.display = "none";
  document.getElementById("quizScreen").style.display = "block";
  document.getElementById("totalQuestion").innerText = soal.length;
  loadSoal();
}

function loadSoal() {
  document.getElementById("questionNum").innerText = i + 1;
  document.getElementById("question").innerText = soal[i].q;
  for (let x = 0; x < 4; x++) {
    document.getElementById("o"+x).innerText = soal[i].o[x];
  }
  document.getElementById("feedback").innerText = "";
}

function answer(pilih) {
  if (pilih === soal[i].a) {
    point += 10;
    document.getElementById("feedback").innerText = "‚úÖ Benar! +10 Point";
    document.getElementById("feedback").className = "feedback-correct";
  } else {
    wrong++;
    document.getElementById("feedback").innerText = "‚ùå Salah! Jawaban: " + soal[i].o[soal[i].a];
    document.getElementById("feedback").className = "feedback-incorrect";
    document.getElementById("wrongCount").innerText = wrong;
    
    if (wrong >= 5) {
      setTimeout(gameOver, 800);
      return;
    }
  }

  updateScore();
  i++;

  if (i < soal.length) {
    setTimeout(loadSoal, 800);
  } else {
    selesai();
  }
}

function updateScore() {
  document.getElementById("point").innerText = point;
  const maxPoint = soal.length * 10;
  const percent = Math.round((point / maxPoint) * 100);
  document.getElementById("scoreProgress").style.width = percent + "%";
  document.getElementById("scoreProgress").innerText = percent + "%";
}

function selesai() {
  const nilai = Math.max(0, Math.round((point / (soal.length * 10)) * 100));
  let peringkat = "";
  let message = "";

  if (nilai >= 90) {
    peringkat = "‚≠ê‚≠ê‚≠ê‚≠ê Baik Sekali";
    message = "Luar biasa! Kamu sangat mahir!";
  } else if (nilai >= 75) {
    peringkat = "‚≠ê‚≠ê‚≠ê Baik";
    message = "Bagus! Terus tingkatkan belajarmu!";
  } else if (nilai >= 60) {
    peringkat = "‚≠ê‚≠ê Cukup";
    message = "Cukup baik, tapi jangan berhenti belajar!";
  } else {
    peringkat = "‚≠ê Kurang";
    message = "Belajar lebih giat lagi ya! Semangat!";
  }

  document.getElementById("quizScreen").style.display = "none";
  document.getElementById("resultScreen").style.display = "block";
  document.getElementById("playerNameDisplay").innerText = "üë§ " + playerName;
  document.getElementById("finalPoint").innerText = point;
  document.getElementById("finalScore").innerText = nilai;
  document.getElementById("finalRank").innerText = peringkat;
  document.getElementById("rankMessage").innerText = message;

  kirimKeSpreadsheet(playerName, point, nilai, peringkat);
}

function gameOver() {
  document.getElementById("quizScreen").style.display = "none";
  document.getElementById("gameOverScreen").style.display = "block";
  document.getElementById("gameOverPlayerName").innerText = "üë§ " + playerName;
  document.getElementById("gameOverQuestions").innerText = i + " dari " + soal.length;
  document.getElementById("gameOverPoint").innerText = point;

  kirimKeSpreadsheet(playerName, point, 0, "Game Over");
}

function kirimKeSpreadsheet(nama, score, nilai, ranking) {
  const data = new URLSearchParams();
  data.append("nama", nama);
  data.append("score", score);
  data.append("nilai", nilai);
  data.append("peringkat", ranking);
  data.append("tanggal", new Date().toLocaleDateString("id-ID"));
  data.append("waktu", new Date().toLocaleTimeString("id-ID"));

  fetch(GOOGLE_APPS_SCRIPT_URL, {
    method: "POST",
    mode: "no-cors",
    body: data
  })
  .then(response => {
    console.log("Data terkirim ke Google Sheets ‚úÖ", { nama, score, nilai, ranking });
  })
  .catch(err => {
    console.error("Gagal kirim data:", err);
  });
}
</script>

</body>
</html>
